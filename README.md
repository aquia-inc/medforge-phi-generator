# Synthetic PHI Data Generator (MedForge)

Production-ready synthetic Protected Health Information (PHI) document generator for training Microsoft Purview DLP systems.

## Quick Start

```bash
# Generate 100 documents (default mix)
./medforge generate --count 100

# Generate with specific formats
./medforge generate --count 500 --formats pdf,docx,eml

# Validate generated documents
./medforge validate output/medforge

# View statistics
./medforge stats output/medforge --tree
```

## Requirements

- Python 3.11+
- uv (package manager)
- Anthropic API key (for LLM enhancement)

## Setup

```bash
# Install dependencies
uv sync

# Set API key in .env
echo "ANTHROPIC_API_KEY=your-key-here" >> .env

# Make CLI executable
chmod +x medforge

# Run linting checks (optional)
./lint.sh
```

## Features

✅ **6 File Formats**: DOCX, PDF, XLSX, PPTX, EML, Nested (emails with attachments)
✅ **LLM Enhancement**: Claude 4.5 Sonnet for clinical narratives (20% default)
✅ **Component Mixing**: 240 unique layout variations per template
✅ **Parallel Processing**: Multi-worker generation for speed
✅ **Validation System**: Automated PHI detection and file integrity checks
✅ **Statistics & Reporting**: Comprehensive analysis of generated datasets

## Project Structure

```
synth_phi_data/
├── src/
│   ├── cli.py                   # Main CLI interface
│   ├── formatters/              # Document generators (6 formats)
│   ├── generators/              # Data & LLM generators
│   ├── templates/               # Component mixing system
│   └── validators/              # PHI validation
├── config/
│   └── example.yaml             # Sample configuration
├── output/                      # Generated documents
├── medforge                     # CLI executable
└── .env                         # API keys (create this)
```

## Documentation

- `CLAUDE.md` - Original project plan
- `PROJECT_STATUS.md` - Implementation details
- `config/example.yaml` - Configuration reference
- `_archive/extra_docs/` - Additional documentation

## Archived Files

Test scripts and old implementations are in `_archive/`:
- `old_test_scripts/` - POC and test generators
- `old_formatters/` - Superseded formatter versions
- `test_outputs/` - 120 test documents (3.1MB)
- `extra_docs/` - Implementation notes

## CLI Commands

### Generate Documents
```bash
medforge generate [OPTIONS]

Options:
  --count, -c INTEGER              Total documents [default: 200]
  --phi-positive INTEGER           PHI positive documents
  --phi-negative INTEGER           PHI negative documents
  --formats, -f TEXT               Formats: pdf,docx,xlsx,eml,pptx
  --output, -o PATH                Output directory
  --llm-percentage FLOAT           LLM enhancement 0.0-1.0 [default: 0.2]
  --seed, -s INTEGER               Random seed
  --parallel-workers, -p INTEGER   Worker count [default: 1]
  --config PATH                    YAML config file
```

### Validate Documents
```bash
medforge validate <path> [--verbose]
```

### View Statistics
```bash
medforge stats <path> [--tree]
```

## Performance

- **Template-based**: ~50 docs/second
- **With LLM (20%)**: ~5-10 docs/minute
- **Parallel (4 workers)**: ~20-40 docs/minute with LLM

## Cost Estimates

- **500 documents**: ~$10-15 (with 20% LLM)
- **1000 documents**: ~$20-30 (with 20% LLM)
- **Template-only**: Free (set `--llm-percentage 0`)

## License

CMS Project - Internal Use

---

**Generated by:** Claude 4.5 Sonnet (Anthropic)
**Status:** Production Ready
